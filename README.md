# DiffLight - äº¤é€šæµé‡æ•°æ®åˆ†æå¹³å°

DiffLight æ˜¯ä¸€ä¸ªåŸºäº Vue 3 + Spring Boot çš„å‰åç«¯åˆ†ç¦»äº¤é€šæµé‡æ•°æ®åˆ†æå¹³å°ï¼Œæä¾›æ•°æ®é›†ç®¡ç†ã€å‚æ•°é…ç½®ã€ç»“æœå±•ç¤ºç­‰åŠŸèƒ½ã€‚

## ğŸ¯ åŠŸèƒ½ç‰¹æ€§

### ç”¨æˆ·åŠŸèƒ½
- **ç”¨æˆ·è®¤è¯**ï¼šæ³¨å†Œã€ç™»å½•ã€ä¸ªäººä¿¡æ¯ç®¡ç†
- **æ•°æ®é›†ç®¡ç†**ï¼šä¸Šä¼ ã€ä¸‹è½½ã€ç®¡ç†ä¸ªäººæ•°æ®é›†
- **å‚æ•°è®¾ç½®**ï¼šé…ç½®åˆ†æå‚æ•°ï¼ŒæŸ¥çœ‹ç»“æœå›¾è¡¨
- **ç»“æœå±•ç¤º**ï¼šè½®æ’­å›¾å±•ç¤ºå¡«è¡¥ç»“æœå›¾ã€åŠ å™ªè¿‡ç¨‹å›¾ã€å»å™ªè¿‡ç¨‹å›¾

### ç®¡ç†å‘˜åŠŸèƒ½
- **æ•°æ®é›†ç®¡ç†**ï¼šç®¡ç†æ‰€æœ‰ç”¨æˆ·æ•°æ®é›†ï¼Œä¸Šä¼ å…±äº«æ•°æ®é›†
- **ç”¨æˆ·ç®¡ç†**ï¼šæŸ¥çœ‹ã€ç¼–è¾‘ç”¨æˆ·ä¿¡æ¯ï¼Œé‡ç½®å¯†ç 
- **å‚æ•°ç®¡ç†**ï¼šç»´æŠ¤å‚æ•°é€‰é¡¹ï¼Œç®¡ç†å‚æ•°ç»„åˆä¸ç»“æœå›¾ç‰‡æ˜ å°„

## ğŸ—ï¸ æŠ€æœ¯æ¶æ„

### å‰ç«¯æŠ€æœ¯æ ˆ
- **Vue 3** - æ¸è¿›å¼ JavaScript æ¡†æ¶
- **Vite** - ç°ä»£åŒ–æ„å»ºå·¥å…·
- **Element Plus** - Vue 3 UI ç»„ä»¶åº“
- **Vue Router** - å®˜æ–¹è·¯ç”±ç®¡ç†å™¨
- **Pinia** - Vue 3 çŠ¶æ€ç®¡ç†
- **Axios** - HTTP å®¢æˆ·ç«¯

### åç«¯æŠ€æœ¯æ ˆ
- **Spring Boot 3** - Java ä¼ä¸šçº§åº”ç”¨æ¡†æ¶
- **Spring Security** - å®‰å…¨æ¡†æ¶ï¼ŒJWT é‰´æƒ
- **Spring Data JPA** - æ•°æ®è®¿é—®å±‚
- **MySQL 8** - å…³ç³»å‹æ•°æ®åº“
- **Swagger/OpenAPI** - API æ–‡æ¡£ç”Ÿæˆ
- **Lombok** - Java ä»£ç ç®€åŒ–

### éƒ¨ç½²æŠ€æœ¯
- **Docker & Docker Compose** - å®¹å™¨åŒ–éƒ¨ç½²
- **Nginx** - åå‘ä»£ç†å’Œé™æ€æ–‡ä»¶æœåŠ¡

## ğŸš€ å¿«é€Ÿå¼€å§‹

### ç¯å¢ƒè¦æ±‚
- Java 17+
- Node.js 18+
- MySQL 8.0+
- Docker & Docker Compose (å¯é€‰)

### ä½¿ç”¨ Docker éƒ¨ç½² (æ¨è)

1. **å…‹éš†é¡¹ç›®**
```bash
git clone https://github.com/20040120lxs/traffic.git
cd traffic
```

2. **æ„å»ºåç«¯**
```bash
cd backend
mvn clean package -DskipTests
cd ..
```

3. **æ„å»ºå‰ç«¯**
```bash
cd frontend
npm install
npm run build
cd ..
```

4. **å¯åŠ¨æœåŠ¡**
```bash
docker-compose up -d
```

5. **è®¿é—®åº”ç”¨**
- å‰ç«¯ï¼šhttp://localhost:3000
- åç«¯ APIï¼šhttp://localhost:8080
- Swagger æ–‡æ¡£ï¼šhttp://localhost:8080/swagger-ui.html

### æœ¬åœ°å¼€å‘éƒ¨ç½²

#### 1. æ•°æ®åº“è®¾ç½®
```sql
CREATE DATABASE traffic_db CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci;
```

#### 2. åç«¯å¯åŠ¨
```bash
cd backend

# é…ç½®ç¯å¢ƒå˜é‡ (å¯é€‰ï¼Œä½¿ç”¨ .env æ–‡ä»¶)
cp ../.env.example .env

# å¯åŠ¨åº”ç”¨
mvn spring-boot:run
```

#### 3. å‰ç«¯å¯åŠ¨
```bash
cd frontend

# å®‰è£…ä¾èµ–
npm install

# å¯åŠ¨å¼€å‘æœåŠ¡å™¨
npm run dev
```

#### 4. è®¿é—®åº”ç”¨
- å‰ç«¯å¼€å‘æœåŠ¡å™¨ï¼šhttp://localhost:3000
- åç«¯ APIï¼šhttp://localhost:8080
- Swagger æ–‡æ¡£ï¼šhttp://localhost:8080/swagger-ui.html

## ğŸ“‹ é»˜è®¤è´¦å·

### ç®¡ç†å‘˜è´¦å·
- **ç”¨æˆ·å**ï¼šadmin
- **å¯†ç **ï¼šAdmin@123
- **æ‰‹æœºå·**ï¼š13800000000

### å‚æ•°é€‰é¡¹
ç³»ç»Ÿé¢„ç½®äº†ä»¥ä¸‹å‚æ•°é€‰é¡¹ï¼š
- **äº¤é€šæ–‡ä»¶**ï¼šhangzhou, jinan
- **è·¯ç½‘æ–‡ä»¶**ï¼šroadnet_3_4, roadnet_4_4
- **äº¤å‰å£æ•°é‡**ï¼š16, 12
- **ç¼ºå¤±æ¨¡å¼**ï¼šrandom_missing, kriging missing
- **ç¼ºå¤±ç‡**ï¼š10%, 30%, 50%, 6.25%, 12.5%, 18.75%, 8.33%, 16.67%, 25%

## ğŸ—‚ï¸ é¡¹ç›®ç»“æ„

```
traffic/
â”œâ”€â”€ backend/                    # Spring Boot åç«¯
â”‚   â”œâ”€â”€ src/main/java/
â”‚   â”‚   â””â”€â”€ com/traffic/difflight/
â”‚   â”‚       â”œâ”€â”€ config/         # é…ç½®ç±»
â”‚   â”‚       â”œâ”€â”€ controller/     # æ§åˆ¶å™¨
â”‚   â”‚       â”œâ”€â”€ dto/           # æ•°æ®ä¼ è¾“å¯¹è±¡
â”‚   â”‚       â”œâ”€â”€ entity/        # å®ä½“ç±»
â”‚   â”‚       â”œâ”€â”€ repository/    # æ•°æ®è®¿é—®å±‚
â”‚   â”‚       â”œâ”€â”€ security/      # å®‰å…¨é…ç½®
â”‚   â”‚       â””â”€â”€ service/       # ä¸šåŠ¡é€»è¾‘å±‚
â”‚   â”œâ”€â”€ src/main/resources/
â”‚   â”‚   â””â”€â”€ application.yml    # åº”ç”¨é…ç½®
â”‚   â”œâ”€â”€ Dockerfile
â”‚   â””â”€â”€ pom.xml
â”œâ”€â”€ frontend/                   # Vue 3 å‰ç«¯
â”‚   â”œâ”€â”€ src/
â”‚   â”‚   â”œâ”€â”€ components/        # å¯å¤ç”¨ç»„ä»¶
â”‚   â”‚   â”œâ”€â”€ router/           # è·¯ç”±é…ç½®
â”‚   â”‚   â”œâ”€â”€ stores/           # Pinia çŠ¶æ€ç®¡ç†
â”‚   â”‚   â”œâ”€â”€ utils/            # å·¥å…·ç±»
â”‚   â”‚   â”œâ”€â”€ views/            # é¡µé¢ç»„ä»¶
â”‚   â”‚   â”‚   â””â”€â”€ admin/        # ç®¡ç†å‘˜é¡µé¢
â”‚   â”‚   â””â”€â”€ App.vue
â”‚   â”œâ”€â”€ Dockerfile
â”‚   â”œâ”€â”€ nginx.conf
â”‚   â”œâ”€â”€ package.json
â”‚   â””â”€â”€ vite.config.js
â”œâ”€â”€ uploads/                    # æ–‡ä»¶ä¸Šä¼ ç›®å½•
â”‚   â”œâ”€â”€ datasets/              # æ•°æ®é›†æ–‡ä»¶
â”‚   â””â”€â”€ results/               # ç»“æœå›¾ç‰‡
â”œâ”€â”€ docker-compose.yml          # Docker ç¼–æ’æ–‡ä»¶
â”œâ”€â”€ init.sql                   # æ•°æ®åº“åˆå§‹åŒ–è„šæœ¬
â”œâ”€â”€ .env.example               # ç¯å¢ƒå˜é‡ç¤ºä¾‹
â””â”€â”€ README.md
```

## ğŸ“– API æ–‡æ¡£

### è®¤è¯ç›¸å…³
- `POST /api/auth/register` - ç”¨æˆ·æ³¨å†Œ
- `POST /api/auth/login` - ç”¨æˆ·ç™»å½•
- `POST /api/admin/login` - ç®¡ç†å‘˜ç™»å½•
- `GET /api/auth/me` - è·å–å½“å‰ç”¨æˆ·ä¿¡æ¯
- `PUT /api/auth/me` - æ›´æ–°ç”¨æˆ·ä¿¡æ¯

### æ•°æ®é›†ç®¡ç†
- `POST /api/datasets/upload` - ä¸Šä¼ æ•°æ®é›†
- `GET /api/datasets/my` - è·å–æˆ‘çš„æ•°æ®é›†
- `GET /api/datasets/shared` - è·å–å…±äº«æ•°æ®é›†
- `GET /api/datasets/{id}/download` - ä¸‹è½½æ•°æ®é›†
- `DELETE /api/datasets/{id}` - åˆ é™¤æ•°æ®é›†

### å‚æ•°è®¾ç½®
- `GET /api/params/options` - è·å–å‚æ•°é€‰é¡¹
- `POST /api/params/query` - æŸ¥è¯¢å‚æ•°ç»“æœ

### ç®¡ç†å‘˜åŠŸèƒ½
- `GET /api/admin/datasets` - è·å–æ‰€æœ‰æ•°æ®é›†
- `POST /api/admin/datasets/upload` - ä¸Šä¼ å…±äº«æ•°æ®é›†
- `DELETE /api/admin/datasets/{id}` - åˆ é™¤ä»»æ„æ•°æ®é›†
- `POST /api/admin/params/options` - æ·»åŠ å‚æ•°é€‰é¡¹
- `DELETE /api/admin/params/options` - åˆ é™¤å‚æ•°é€‰é¡¹
- `POST /api/admin/results` - ä¸Šä¼ ç»“æœå›¾ç‰‡
- `GET /api/admin/results` - è·å–æ‰€æœ‰ç»“æœ
- `DELETE /api/admin/results/{id}` - åˆ é™¤ç»“æœ

å®Œæ•´çš„ API æ–‡æ¡£å¯è®¿é—®ï¼šhttp://localhost:8080/swagger-ui.html

## ğŸ”§ é…ç½®è¯´æ˜

### ç¯å¢ƒå˜é‡

ä¸»è¦çš„ç¯å¢ƒå˜é‡é…ç½®é¡¹ï¼š

| å˜é‡å | è¯´æ˜ | é»˜è®¤å€¼ |
|--------|------|--------|
| DB_HOST | æ•°æ®åº“ä¸»æœº | localhost |
| DB_PORT | æ•°æ®åº“ç«¯å£ | 3306 |
| DB_NAME | æ•°æ®åº“åç§° | traffic_db |
| DB_USERNAME | æ•°æ®åº“ç”¨æˆ·å | root |
| DB_PASSWORD | æ•°æ®åº“å¯†ç  | root123 |
| JWT_SECRET | JWT å¯†é’¥ | mySecretKey... |
| JWT_EXPIRATION | JWT è¿‡æœŸæ—¶é—´(æ¯«ç§’) | 86400000 |
| FILE_UPLOAD_DIR | æ–‡ä»¶ä¸Šä¼ ç›®å½• | uploads |
| SERVER_PORT | æœåŠ¡å™¨ç«¯å£ | 8080 |

### å‚æ•°ç»„åˆæ˜ å°„è§„åˆ™

æ ¹æ®éœ€æ±‚ï¼Œç³»ç»Ÿæ”¯æŒä»¥ä¸‹æœ‰æ•ˆçš„å‚æ•°ç»„åˆï¼š

1. **hangzhou + roadnet_4_4 + 16**
   - random_missing: 10%, 30%, 50%
   - kriging missing: 6.25%, 12.5%, 18.75%

2. **jinan + roadnet_3_4 + 16**
   - random_missing: 10%, 30%, 50%
   - kriging missing: 8.33%, 16.67%, 25%

æ¯ç§æœ‰æ•ˆç»„åˆå¯¹åº” 3 å¼ å›¾ç‰‡ï¼šå¡«è¡¥ç»“æœå›¾ã€åŠ å™ªè¿‡ç¨‹å›¾ã€å»å™ªè¿‡ç¨‹å›¾ã€‚

## ğŸ› ï¸ å¼€å‘æŒ‡å—

### æ·»åŠ æ–°çš„å‚æ•°é€‰é¡¹
1. ä½¿ç”¨ç®¡ç†å‘˜è´¦å·ç™»å½•
2. é€šè¿‡ API æˆ–æ•°æ®åº“ç›´æ¥æ·»åŠ åˆ° `param_options` è¡¨
3. å‰ç«¯ä¼šè‡ªåŠ¨è·å–æœ€æ–°çš„å‚æ•°é€‰é¡¹

### ä¸Šä¼ ç»“æœå›¾ç‰‡
1. ä½¿ç”¨ç®¡ç†å‘˜è´¦å·ç™»å½•
2. è®¿é—®ç®¡ç†å‘˜åŠŸèƒ½ï¼ˆéœ€è¦å®Œå–„åç«¯æ¥å£ï¼‰
3. é€‰æ‹©å‚æ•°ç»„åˆå¹¶ä¸Šä¼ å¯¹åº”çš„ä¸‰å¼ å›¾ç‰‡

### æ‰©å±•åŠŸèƒ½
- ä¿®æ”¹ `/backend/src/main/java/com/traffic/difflight/` ä¸‹çš„ç›¸åº”ç±»
- ä¿®æ”¹ `/frontend/src/` ä¸‹çš„å¯¹åº”ç»„ä»¶
- æ›´æ–° API æ–‡æ¡£

## ğŸ” æ•…éšœæ’é™¤

### å¸¸è§é—®é¢˜

1. **æ•°æ®åº“è¿æ¥å¤±è´¥**
   - æ£€æŸ¥ MySQL æœåŠ¡æ˜¯å¦å¯åŠ¨
   - éªŒè¯æ•°æ®åº“è¿æ¥é…ç½®
   - ç¡®è®¤æ•°æ®åº“ç”¨æˆ·æƒé™

2. **æ–‡ä»¶ä¸Šä¼ å¤±è´¥**
   - æ£€æŸ¥ `uploads` ç›®å½•æƒé™
   - ç¡®è®¤æ–‡ä»¶å¤§å°ä¸è¶…è¿‡ 100MB
   - éªŒè¯æ–‡ä»¶æ ¼å¼æ˜¯å¦æ”¯æŒ

3. **JWT è®¤è¯å¤±è´¥**
   - æ£€æŸ¥ JWT å¯†é’¥é…ç½®
   - ç¡®è®¤ token æœªè¿‡æœŸ
   - éªŒè¯è¯·æ±‚å¤´æ ¼å¼

4. **å‰ç«¯ä»£ç†å¤±è´¥**
   - æ£€æŸ¥åç«¯æœåŠ¡æ˜¯å¦å¯åŠ¨åœ¨ 8080 ç«¯å£
   - éªŒè¯ vite.config.js ä¸­çš„ä»£ç†é…ç½®
   - ç¡®è®¤ CORS é…ç½®æ­£ç¡®

### æ—¥å¿—æŸ¥çœ‹

- **åç«¯æ—¥å¿—**ï¼šæŸ¥çœ‹ Spring Boot æ§åˆ¶å°è¾“å‡º
- **å‰ç«¯æ—¥å¿—**ï¼šæŸ¥çœ‹æµè§ˆå™¨å¼€å‘è€…å·¥å…· Console
- **Docker æ—¥å¿—**ï¼š`docker-compose logs [service_name]`

## ğŸ“„ è®¸å¯è¯

[MIT License](LICENSE)

## ğŸ¤ è´¡çŒ®

æ¬¢è¿æäº¤ Issue å’Œ Pull Request æ¥æ”¹è¿›é¡¹ç›®ã€‚

## ğŸ“ è”ç³»æ–¹å¼

å¦‚æœ‰é—®é¢˜ï¼Œè¯·é€šè¿‡ GitHub Issues è”ç³»æˆ‘ä»¬ã€‚